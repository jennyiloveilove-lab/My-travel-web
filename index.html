<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å€‹äººæ—…æ—¥è¨˜ V36 âœˆï¸</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-blue: #64cccc; --bg-light: #f4fbfb; --text-dark: #2d5a5a; }
        body { background-color: var(--bg-light); font-family: 'Zen Maru Gothic', sans-serif; color: var(--text-dark); }
        .app-container { max-width: 480px; margin: 0 auto; min-height: 100vh; padding-bottom: 50px; }
        .top-nav { background: var(--primary-blue); color: white; border-radius: 0 0 2.5rem 2.5rem; padding: 2.5rem 1.5rem 2rem; position: relative; }
        
        /* å³ä¸Šè§’æŒ‰éˆ•çµ„ */
        .top-actions { display: flex; gap: 8px; position: absolute; top: 2.5rem; right: 1.5rem; }
        .action-btn { width: 40px; height: 40px; border-radius: 12px; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center; color: white; }

        .card-event { background: white; border-radius: 24px; padding: 20px; border: 1px solid #eef7f7; box-shadow: 0 4px 12px rgba(0,0,0,0.02); position: relative; margin-bottom: 16px; }
        .map-nav-btn { position: absolute; bottom: 18px; right: 18px; width: 42px; height: 42px; border-radius: 12px; background: #f0f9f9; color: var(--primary-blue); display: flex; align-items: center; justify-content: center; border: 1px solid #e0f2f2; }
        
        .photo-upload-zone { border: 2px dashed #64cccc; border-radius: 24px; padding: 30px; text-align: center; color: #64cccc; background: rgba(100,204,204,0.02); margin-top: 20px; }
        .modal-overlay { background: rgba(0,0,0,0.3); backdrop-filter: blur(8px); position: fixed; inset: 0; z-index: 100; display: flex; align-items: flex-end; }
        .modal-content { background: white; width: 100%; border-radius: 3rem 3rem 0 0; padding: 2rem; max-height: 90vh; overflow-y: auto; }
        .fab-add { position: fixed; bottom: 35px; right: 25px; width: 64px; height: 64px; border-radius: 50%; background: var(--primary-blue); color: white; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 10px 25px rgba(100,204,204,0.3); border: 4px solid white; z-index: 90; cursor: pointer; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

<div id="app" class="app-container">
    <header class="top-nav mb-6">
        <div class="flex justify-between items-start mb-4">
            <div>
                <h1 class="text-xl font-black tracking-tight">æ—…æ—¥è¨˜</h1>
                <p class="text-[10px] opacity-70 font-bold uppercase mt-1">My Travel Journal</p>
            </div>
            <div class="top-actions">
                <button @click="currentView = 'expense'" class="action-btn"><i class="fa-solid fa-wallet"></i></button>
                <button @click="currentView = 'shopping'" class="action-btn"><i class="fa-solid fa-bag-shopping"></i></button>
                <button class="action-btn"><i class="fa-solid fa-gear"></i></button>
            </div>
        </div>
        <div class="bg-white/10 p-4 rounded-3xl border border-white/10 mt-2">
            <p class="text-sm font-black">â˜€ï¸ {{ temperature }}Â° C æ–¼ {{ location }}</p>
            <p class="text-[10px] opacity-80">å¤©æ°£å¥½æ­£ï¼Œå‡ºç™¼å•¦ï¼</p>
        </div>

        <div class="flex gap-3 overflow-x-auto no-scrollbar py-4 mt-2">
            <div v-for="(day, index) in itinerary" :key="index" @click="activeDay = index; currentView = 'itinerary'"
                class="min-w-[60px] p-3 rounded-2xl bg-white text-center transition-all"
                :style="activeDay === index && currentView === 'itinerary' ? 'border:2px solid #64cccc' : 'opacity:0.6'">
                <span class="text-[8px] block opacity-40 uppercase">Day {{ index + 1 }}</span>
                <span class="font-black text-sm">{{ getTabDate(index) }}</span>
            </div>
            <button @click="addDay" class="min-w-[40px] rounded-2xl bg-white/20 text-white font-bold text-xl">+</button>
        </div>
    </header>

    <main v-if="currentView === 'itinerary'" class="px-6">
        <div v-for="(event, eIdx) in itinerary[activeDay].events" :key="event.id" class="card-event" @click="openEdit(eIdx)">
            <div class="flex justify-between items-start mb-1">
                <span class="text-[10px] font-black text-gray-300">{{ event.time }} {{ getEmoji(event.category) }}</span>
                <span v-if="event.cost > 0" class="text-[10px] font-black text-[#64cccc]">Â¥{{ event.cost.toLocaleString() }}</span>
            </div>
            <h3 class="text-lg font-black">
                <template v-if="event.category === 'flight'">{{ event.from }} âœˆï¸ {{ event.location }}</template>
                <template v-else>{{ event.location }}</template>
            </h3>
            <button @click.stop="autoSearchMap(event.location)" class="map-nav-btn"><i class="fa-solid fa-map-location-dot"></i></button>
        </div>
        <div v-if="itinerary[activeDay].events.length === 0" class="text-center py-20 opacity-20 font-bold italic">ä»Šæ—¥æœªæœ‰å®‰æ’ï¼Œæ’³ + é–‹å§‹å•¦ï¼</div>
    </main>

    <main v-if="currentView === 'shopping'" class="px-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-black border-b-4 border-[#64cccc] pb-1">æƒ³è²·æ¸…å–®</h2>
            <span class="text-xs bg-cyan-50 text-[#64cccc] px-3 py-1 rounded-full font-bold">å·²å®Œæˆ {{ doneCount }}/{{ shoppingList.length }}</span>
        </div>
        <div class="bg-white rounded-3xl p-4 shadow-sm border border-cyan-50 mb-6">
            <div class="flex gap-2">
                <input v-model="newItemName" @keyup.enter="addShopItem" placeholder="ä¾‹å¦‚ï¼šåˆåˆ©ä»–å‘½" class="flex-1 bg-cyan-50/30 rounded-xl px-4 text-sm font-bold outline-none">
                <button @click="addShopItem" class="bg-[#64cccc] text-white px-5 py-2 rounded-xl font-black text-sm">Add</button>
            </div>
        </div>
        <div v-for="(item, index) in shoppingList" :key="index" @click="toggleShopItem(index)" class="flex items-center gap-3 bg-white p-4 rounded-2xl mb-2 shadow-sm">
            <i :class="item.done ? 'fa-solid fa-circle-check text-[#64cccc]' : 'fa-regular fa-circle text-gray-200'" class="text-xl"></i>
            <span class="text-sm font-bold flex-1" :class="{ 'line-through opacity-30': item.done }">{{ item.name }}</span>
            <button @click.stop="removeShopItem(index)" class="text-gray-200 text-xs">Ã—</button>
        </div>
    </main>

    <button @click="openAdd" class="fab-add"><i class="fa-solid fa-plus"></i></button>

    <div v-if="showModal" class="modal-overlay" @click.self="showModal = false">
        <div class="modal-content no-scrollbar">
            <div class="flex justify-between items-center mb-6">
                <h3 class="font-black text-xl">{{ isNew ? 'âœ¨ æ–°å¢è¡Œç¨‹' : 'ğŸ“ ç·¨è¼¯è¡Œç¨‹' }}</h3>
                <button @click="showModal = false" class="text-gray-300 text-3xl">Ã—</button>
            </div>
            
            <div class="space-y-4">
                <div class="flex gap-2 overflow-x-auto no-scrollbar mb-4">
                    <button v-for="cat in categories" :key="cat.id" @click="form.category = cat.id"
                        :class="form.category === cat.id ? 'bg-[#64cccc] text-white' : 'bg-gray-50 text-gray-400'"
                        class="px-4 py-2 rounded-xl min-w-[70px] text-xs font-bold">{{ cat.emoji }} {{ cat.name }}</button>
                </div>

                <div v-if="form.category === 'flight'" class="flex gap-2">
                    <input v-model="form.from" placeholder="From HKG" class="flex-1 bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                    <input v-model="form.location" placeholder="To NRT" class="flex-1 bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                </div>
                <input v-else v-model="form.location" placeholder="ç›®çš„åœ°åç¨±" class="w-full bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                
                <div class="flex gap-2">
                    <input v-model="form.time" type="time" class="flex-1 bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                    <input v-if="form.category === 'flight'" v-model="form.flightNum" placeholder="èˆªç­ç·¨è™Ÿ" class="flex-1 bg-gray-50 p-4 rounded-2xl outline-none font-bold">
                </div>

                <div class="bg-cyan-50/50 p-4 rounded-2xl">
                    <p class="text-[10px] font-bold text-[#64cccc] mb-2 uppercase">é–‹æ”¯è²»ç”¨ (JPY)</p>
                    <input v-model.number="form.cost" type="number" class="bg-transparent text-xl font-black w-full outline-none" placeholder="0">
                    <p class="text-[10px] opacity-40 mt-1">â‰ˆ HK$ {{ (form.cost * 0.052).toFixed(1) }}</p>
                </div>

                <div class="photo-upload-zone"><i class="fa-solid fa-camera text-2xl mb-1"></i><p class="text-[10px] font-bold">åŠ å…¥ç›¸ç‰‡ / å½±ç›¸</p></div>
                <button @click="save" class="w-full bg-[#64cccc] text-white py-4 rounded-2xl font-black shadow-lg">å„²å­˜è¡Œç¨‹</button>
            </div>
        </div>
    </div>
</div>

<script>
const { createApp } = Vue;
createApp({
    data() {
        return {
            currentView: 'itinerary', activeDay: 0, showModal: false, isNew: true,
            location: 'æ²™ç”°å€', temperature: 13,
            itinerary: [{ events: [] }],
            shoppingList: [], newItemName: '',
            categories: [{id:'spot',name:'æ™¯é»',emoji:'ğŸŒ¸'},{id:'eat',name:'é£²é£Ÿ',emoji:'ğŸ±'},{id:'shop',name:'è³¼ç‰©',emoji:'ğŸ›ï¸'},{id:'hotel',name:'é…’åº—',emoji:'ğŸ¨'},{id:'transport',name:'äº¤é€š',emoji:'ğŸšƒ'},{id:'flight',name:'èˆªç­',emoji:'âœˆï¸'}],
            form: { category: 'spot', location: '', from: '', time: '12:00', cost: 0, flightNum: '' }
        }
    },
    computed: { doneCount() { return this.shoppingList.filter(i => i.done).length; } },
    methods: {
        getEmoji(id) { return this.categories.find(c => c.id === id)?.emoji || 'ğŸ“'; },
        getTabDate(i) { const d = new Date(); d.setDate(d.getDate() + i); return `${d.getMonth()+1}/${d.getDate()}`; },
        autoSearchMap(loc) { if(loc) window.open(`http://googleusercontent.com/maps.google.com/2{encodeURIComponent(loc)}`, '_blank'); },
        addDay() { this.itinerary.push({ events: [] }); this.saveLocal(); },
        openAdd() { 
            this.isNew = true; 
            this.form = { category: 'spot', location: '', from: '', time: '12:00', cost: 0, flightNum: '' };
            this.showModal = true; 
        },
        openEdit(idx) { 
            this.isNew = false; this.editIdx = idx;
            this.form = {...this.itinerary[this.activeDay].events[idx]};
            this.showModal = true;
        },
        save() {
            if(this.isNew) this.itinerary[this.activeDay].events.push({...this.form});
            else this.itinerary[this.activeDay].events[this.editIdx] = {...this.form};
            this.itinerary[this.activeDay].events.sort((a,b) => a.time.localeCompare(b.time));
            this.showModal = false; this.saveLocal();
        },
        addShopItem() { if(this.newItemName) { this.shoppingList.push({name:this.newItemName, done:false}); this.newItemName=''; this.saveLocal(); } },
        toggleShopItem(idx) { this.shoppingList[idx].done = !this.shoppingList[idx].done; this.saveLocal(); },
        removeShopItem(idx) { this.shoppingList.splice(idx,1); this.saveLocal(); },
        saveLocal() { localStorage.setItem('travel_v36', JSON.stringify({itinerary:this.itinerary, shopping:this.shoppingList})); }
    },
    mounted() {
        const data = JSON.parse(localStorage.getItem('travel_v36'));
        if(data) { this.itinerary = data.itinerary; this.shoppingList = data.shopping || []; }
    }
}).mount('#app');
</script>
</body>
</html>